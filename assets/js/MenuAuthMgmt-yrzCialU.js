import{A as e,b as t,n as a,v as i,w as r,e as d,d as n,t as l,h as u,p as o,q as s,i as g,u as m,r as c,B as h,C as v,s as p,D as C,G as w,U as f,T as I,k as M}from"./index-WruVlziS.js";import{E as A}from"./element-split-panes-BucNCvQW.js";import{E as y}from"./element-text-BpkoH2im.js";import{g as k}from"./gridUtils-DjHApC85.js";import{g as R,R as T}from"./real-grid-BQCIEb0Q.js";import{T as P}from"./tree-grid-3Gd96qRy.js";import{C as V}from"./container-view-CBvq7VkV.js";import{S as D}from"./search-container-5xxIWbSQ.js";import"./popup-container-Dv1dBd7I.js";import"./footer-view-BaCAMA_D.js";const{t:S}=e.global,$=(e,t)=>({programId:e,gridId:t,gridTitle:S(`${e}.${t}.title`),setting:{checkBarVisible:!1,isReadOnly:!0},columns:[R.hidden({name:"menuId"}),R.hidden({name:"authCd"}),R.text({headerText:S(`${e}.${t}.authNm`),name:"authNm",width:150,editable:!1}),R.check({headerText:S(`${e}.${t}.authChk`),name:"authChk",width:"150",textAlign:"left"})]}),{t:b}=e.global,j=(e,t)=>({programId:e,gridId:t,gridTitle:b(`${e}.${t}.title`),setting:{checkBarVisible:!1,useFocusClass:!0,isReadOnly:!0},columns:[R.hidden({name:"menuId"}),R.text({headerText:b(`${e}.${t}.menuNmLocale`),name:"menuNmLocale",width:"150",editable:!1})]}),x="gridMenuRef",_="gridAuthRef";const N=t(Object.assign({menuId:"menuAuthMgmt",programId:"MenuAuthMgmt"},{__name:"MenuAuthMgmt",setup(e,{expose:t}){t();const a=s(),i=a?.type.menuId,r=a?.type.programId,{t:d}=u(),n=o("emitter"),l=`mittMenuCheck_${i}`;n.on(l,async e=>{await k.isChangeRowData([{type:"tree",dataProvider:O.value},{dataProvider:Y.value}])&&n.emit(`mitt${e.target}MenuClickEvent`,e.data)});const M=m.cloneDeep(j(r,x)),R=m.cloneDeep($(r,_)),S=c({isReady:!1,comCodes:{},search:{},gridMenuTitle:M.gridTitle,gridMenuView:null,dataMenuProvider:null,gridMenuCellClickData:{},selectedRowInfo:{},gridAuthTitle:R.gridTitle,gridAuthView:null,dataAuthProvider:null}),{isReady:b,comCodes:N,search:E,gridMenuTitle:G,gridMenuView:H,dataMenuProvider:O,selectedRowInfo:U,gridMenuCellClickData:B,gridAuthTitle:L,gridAuthView:J,dataAuthProvider:Y}=g(S);h(async()=>{b.value=!1,await v({programId:r}),W(),await K(),b.value=!0}),p(()=>{n.off(l),m.clearAuth(r)}),C(async()=>{await v({programId:r})}),w(async()=>{m.clearAuth(r)});const q=()=>{I({menuId:"MenuMgmt",params:E.value}).then(e=>{k.setData({type:"tree",gridView:H.value,dataProvider:O.value,data:e.data}),k.setData({gridView:J.value,dataProvider:Y.value,data:[]}),U.value={}})},z=e=>{I({menuId:r,params:{menuId:e.menuId}}).then(e=>{k.setData({gridView:J.value,dataProvider:Y.value,data:e.data})})},F=e=>{I({method:"post",menuId:r,data:e}).then(()=>{z(U.value)})},W=()=>{E.value={idName:""}},K=async()=>{N.value.useYn=f.useYn},Q={instance:a,menuId:i,programId:r,t:d,emitter:n,mittMenuCheck:l,gridMenuId:x,gridMenuConfig:M,gridAuthId:_,gridAuthConfig:R,data:S,isReady:b,comCodes:N,search:E,gridMenuTitle:G,gridMenuView:H,dataMenuProvider:O,selectedRowInfo:U,gridMenuCellClickData:B,gridAuthTitle:L,gridAuthView:J,dataAuthProvider:Y,getMenuDataHandler:q,getAuthDataHandler:z,saveAuthDataHandler:F,resetHandler:W,init:K,searchHandler:async()=>{await k.isChangeRowData([{type:"tree",dataProvider:O.value},{dataProvider:Y.value}])&&q()},gridMenuInit:async(e,t)=>{H.value=e,O.value=t,q()},gridMenuCellClicked:async(e,t)=>{if(await k.isChangeRowData([{dataProvider:Y.value}])){const e=k.getJsonRow({dataProvider:O.value,dataRow:t.dataRow});U.value=e,B.value=t,z(e)}else e.setCurrent({itemIndex:B.value.itemIndex})},gridAuthInit:async(e,t)=>{J.value=e,Y.value=t},gridAuthSaveClick:async()=>{if(await k.checkValidation({gridView:J.value,dataProvider:Y.value})){const e=await k.saveData({gridView:J.value,dataProvider:Y.value});e.isConfirmed&&F(e.data)}},getCurrentInstance:s,inject:o,onActivated:C,onBeforeMount:h,onDeactivated:w,onUnmounted:p,reactive:c,toRefs:g,get useI18n(){return u},get _comCode(){return f},get utils(){return m},get apiCommon(){return I},get apiPageAuth(){return v},ElementSplitPanes:A,ElementText:y,get gridUtils(){return k},RealGrid:T,TreeGrid:P,ContainerView:V,SearchContainer:D,get gridAuthSetting(){return $},get gridMenuSetting(){return j}};return Object.defineProperty(Q,"__isScriptSetup",{enumerable:!1,value:!0}),Q}}),[["render",function(e,t,u,o,s,g){return o.isReady?(M(),a(o.ContainerView,{key:0},{default:r(()=>[d(o.SearchContainer,{onSearch:o.searchHandler,onReset:o.resetHandler},{colgroup:r(()=>t[1]||(t[1]=[n("col",{width:"150"},null,-1),n("col",{width:"600"},null,-1),n("col",{width:"*"},null,-1)])),default:r(()=>[n("tbody",null,[n("tr",null,[n("th",null,l(o.t(`${o.programId}.search.idName.title`)),1),n("td",null,[d(o.ElementText,{modelValue:o.search.idName,"onUpdate:modelValue":t[0]||(t[0]=e=>o.search.idName=e),placeholder:o.t(`${o.programId}.search.idName.title.placeholder`)},null,8,["modelValue","placeholder"])]),t[2]||(t[2]=n("td",null,null,-1))])])]),_:1}),d(o.ElementSplitPanes,{leftSize:20},{leftSlot:r(()=>[d(o.TreeGrid,{gridTitle:o.gridMenuTitle,gridConfig:o.gridMenuConfig,onGridInit:o.gridMenuInit,onGridCellClicked:o.gridMenuCellClicked},null,8,["gridTitle","gridConfig"])]),rightSlot:r(()=>[d(o.RealGrid,{gridTitle:`${Object.keys(o.selectedRowInfo).length>0?o.t(`${o.programId}.${o.gridAuthId}.title.selected`,{title:o.selectedRowInfo.menuNmLocale}):o.gridAuthTitle}`,gridConfig:o.gridAuthConfig,isEditable:Object.keys(o.selectedRowInfo).length>0,onGridInit:o.gridAuthInit,onGridSaveClick:o.gridAuthSaveClick},null,8,["gridTitle","gridConfig","isEditable"])]),_:1})]),_:1})):i("",!0)}],["__file","/Users/kokimin/WorkSpace/vue_design_system/src/views/MenuAuthMgmt/MenuAuthMgmt.vue"]]);export{N as default};
