import{A as e,b as a,n as t,v as r,w as d,e as i,d as o,t as l,h as n,p as s,q as u,i as g,u as m,r as c,B as p,C,s as v,D as h,G as w,U as f,T as y,k as I}from"./index-WruVlziS.js";import{E as $}from"./element-split-panes-BucNCvQW.js";import{E as T}from"./element-select-BJ9xVWKG.js";import{E as G}from"./element-text-BpkoH2im.js";import{g as V}from"./gridUtils-DjHApC85.js";import{g as x,R as k}from"./real-grid-BQCIEb0Q.js";import{C as R}from"./container-view-CBvq7VkV.js";import{S as P}from"./search-container-5xxIWbSQ.js";import"./popup-container-Dv1dBd7I.js";import"./footer-view-BaCAMA_D.js";const{t:D}=e.global,S=(e,a)=>({programId:e,gridId:a,gridTitle:D(`${e}.${a}.title`),columns:[x.hidden({name:"groupCode"}),x.text({headerText:D(`${e}.${a}.comCode`),name:"comCode",textAlign:"left",isAddEditable:!0,width:120,required:!0,requiredMessage:D(`${e}.${a}.msg.comCode`),primaryKey:!0}),x.text({headerText:D(`${e}.${a}.comName`),name:"comName",textAlign:"left",width:150,required:!0,requiredMessage:D(`${e}.${a}.msg.comName`)}),x.select({headerText:D(`${e}.${a}.useYn`),name:"useYn",required:!0,defaultValue:"Y",width:80}),x.number({headerText:D(`${e}.${a}.orderNum`),name:"orderNum",required:!0,width:80})]}),{t:b}=e.global,j=(e,a)=>({programId:e,gridId:a,gridTitle:b(`${e}.${a}.title`),columns:[x.text({headerText:b(`${e}.${a}.groupCode`),name:"groupCode",width:120,textAlign:"left",isAddEditable:!0,required:!0,requiredMessage:b(`${e}.${a}.msg.groupCode`),primaryKey:!0}),x.text({headerText:b(`${e}.${a}.groupName`),name:"groupName",width:150,textAlign:"left",required:!0,requiredMessage:b(`${e}.${a}.msg.groupName`)}),x.text({headerText:b(`${e}.${a}.description`),name:"description",width:200,textAlign:"left"}),x.select({headerText:b(`${e}.${a}.useYn`),name:"useYn",width:80,defaultValue:"Y"}),x.button({headerText:b(`${e}.${a}.action`),name:"action",width:100})]}),A="gridGroupRef",E="gridCodeRef",M={class:"flex-area"};const _=a(Object.assign({menuId:"comCodeMgmt",programId:"ComCodeMgmt"},{__name:"ComCodeMgmt",setup(e,{expose:a}){a();const t=u(),r=t?.type.menuId,d=t?.type.programId,{t:i}=n(),o=s("emitter"),l=`mittMenuCheck_${r}`;o.on(l,async e=>{await V.isChangeRowData([{dataProvider:U.value},{dataProvider:O.value}])&&o.emit(`mitt${e.target}MenuClickEvent`,e.data)});const I=m.cloneDeep(j(d,A)),x=m.cloneDeep(S(d,E)),D=c({isReady:!1,comCodes:{},search:{},gridGroupTitle:I.gridTitle,gridGroupView:null,dataGroupProvider:null,selectedRowInfo:{},gridCodeTitle:x.gridTitle,gridCodeView:null,dataCodeProvider:null}),{isReady:b,comCodes:M,search:_,gridGroupTitle:Y,gridGroupView:q,dataGroupProvider:U,selectedRowInfo:N,gridCodeTitle:H,gridCodeView:K,dataCodeProvider:O}=g(D);p(async()=>{b.value=!1,await C({programId:d}),z(),await F(),b.value=!0}),v(()=>{o.off(l),m.clearAuth(d)}),h(async()=>{await C({programId:d})}),w(async()=>{m.clearAuth(d)});const B=()=>{y({menuId:d,pathUrl:"comCdGrp",params:_.value}).then(e=>{V.setData({gridView:q.value,dataProvider:U.value,data:e.data}),V.setData({gridView:K.value,dataProvider:O.value,data:[]}),N.value={}})},J=e=>{y({method:"post",menuId:d,pathUrl:"comCdGrp",data:e}).then(()=>{B()})},L=e=>{y({menuId:d,pathUrl:"comCdDtl",params:{groupCode:e.groupCode}}).then(e=>{V.setData({gridView:K.value,dataProvider:O.value,data:e.data})})},W=e=>{y({method:"post",menuId:d,pathUrl:"comCdDtl",data:e}).then(()=>{L(N.value)})},z=()=>{_.value={searchTypeKey:"comCode",searchTypeVal:""}},F=async()=>{M.value.useYn=f.useYn},Q={instance:t,menuId:r,programId:d,t:i,emitter:o,mittMenuCheck:l,gridGroupId:A,gridGroupConfig:I,gridCodeId:E,gridCodeConfig:x,data:D,isReady:b,comCodes:M,search:_,gridGroupTitle:Y,gridGroupView:q,dataGroupProvider:U,selectedRowInfo:N,gridCodeTitle:H,gridCodeView:K,dataCodeProvider:O,getGroupDataHandler:B,saveGroupDataHandler:J,getCodeDataHandler:L,saveCodeDataHandler:W,resetHandler:z,init:F,searchHandler:async()=>{await V.isChangeRowData([{dataProvider:U.value},{dataProvider:O.value}])&&B()},gridGroupInit:async(e,a)=>{q.value=e,U.value=a,await V.setLookupData({gridView:e,field:"useYn",data:M.value.useYn}),B()},gridGroupSaveClick:async()=>{if(await V.checkValidation({gridView:q.value,dataProvider:U.value})&&await V.isChangeRowData([{dataProvider:O.value}],"isChangeRowDataSave")){const e=await V.saveData({gridView:q.value,dataProvider:U.value});e.isConfirmed&&J(e.data)}},gridGroupCellItemClicked:async(e,a,t)=>{if(await V.isChangeRowData([{dataProvider:O.value}])){const e=V.getJsonRow({dataProvider:U.value,dataRow:t.dataRow});N.value=e,L(e)}},gridCodeInit:async(e,a)=>{K.value=e,O.value=a,await V.setLookupData({gridView:e,field:"useYn",data:M.value.useYn})},gridCodeSaveClick:async()=>{if(await V.checkValidation({gridView:K.value,dataProvider:O.value})){const e=await V.saveData({gridView:K.value,dataProvider:O.value});e.isConfirmed&&W(e.data)}},gridCodeAddClick:()=>({defaultData:{groupCode:N.value.groupCode},result:!0}),getCurrentInstance:u,inject:s,onActivated:h,onBeforeMount:p,onDeactivated:w,onUnmounted:v,reactive:c,toRefs:g,get useI18n(){return n},get _comCode(){return f},get utils(){return m},get apiCommon(){return y},get apiPageAuth(){return C},ElementSplitPanes:$,ElementSelect:T,ElementText:G,get gridUtils(){return V},RealGrid:k,ContainerView:R,SearchContainer:P,get gridCodeSetting(){return S},get gridGroupSetting(){return j}};return Object.defineProperty(Q,"__isScriptSetup",{enumerable:!1,value:!0}),Q}}),[["render",function(e,a,n,s,u,g){return s.isReady?(I(),t(s.ContainerView,{key:0},{default:d(()=>[i(s.SearchContainer,{onSearch:s.searchHandler,onReset:s.resetHandler},{colgroup:d(()=>a[2]||(a[2]=[o("col",{width:"150"},null,-1),o("col",{width:"600"},null,-1),o("col",{width:"*"},null,-1)])),default:d(()=>[o("tbody",null,[o("tr",null,[o("th",null,l(s.t("common.title.search")),1),o("td",null,[o("div",M,[i(s.ElementSelect,{modelValue:s.search.searchTypeKey,"onUpdate:modelValue":a[0]||(a[0]=e=>s.search.searchTypeKey=e),options:[{label:"공통코드",value:"comCode"},{label:"설명내용",value:"description"}],width:"200px"},null,8,["modelValue"]),i(s.ElementText,{modelValue:s.search.searchTypeVal,"onUpdate:modelValue":a[1]||(a[1]=e=>s.search.searchTypeVal=e),placeholder:s.t(`${s.programId}.search.searchTypeVal.placeholder`)},null,8,["modelValue","placeholder"])])]),a[3]||(a[3]=o("td",null,null,-1))])])]),_:1}),i(s.ElementSplitPanes,null,{leftSlot:d(()=>[i(s.RealGrid,{gridTitle:s.gridGroupTitle,gridConfig:s.gridGroupConfig,onGridInit:s.gridGroupInit,onGridCellItemClicked:s.gridGroupCellItemClicked,onGridSaveClick:s.gridGroupSaveClick},null,8,["gridTitle","gridConfig"])]),rightSlot:d(()=>[i(s.RealGrid,{gridTitle:`${s.gridCodeTitle}${Object.keys(s.selectedRowInfo).length>0?`: ${s.selectedRowInfo.groupName}`:""}`,gridConfig:s.gridCodeConfig,gridAddClick:s.gridCodeAddClick,isEditable:Object.keys(s.selectedRowInfo).length>0,onGridInit:s.gridCodeInit,onGridSaveClick:s.gridCodeSaveClick},null,8,["gridTitle","gridConfig","isEditable"])]),_:1})]),_:1})):r("",!0)}],["__file","/Users/kokimin/WorkSpace/vue_design_system/src/views/ComCodeMgmt/ComCodeMgmt.vue"]]);export{_ as default};
