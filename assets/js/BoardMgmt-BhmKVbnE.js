import{A as e,b as a,c as t,n as r,v as i,w as d,e as o,d as n,t as l,F as s,S as u,h as c,p as m,i as g,u as p,r as v,B as h,C,s as w,q as f,D as I,G as b,T as y,k as R}from"./index-WruVlziS.js";import{E as P}from"./element-text-BpkoH2im.js";import{g as k}from"./gridUtils-DjHApC85.js";import{g as x,R as T}from"./real-grid-BQCIEb0Q.js";import{C as j}from"./container-view-CBvq7VkV.js";import{P as V}from"./popup-container-Dv1dBd7I.js";import{S as A}from"./search-container-5xxIWbSQ.js";import D from"./BoardPopup-B9iCq4gh.js";import"./footer-view-BaCAMA_D.js";import"./element-date-picker-ParMatNd.js";import"./form-container-BEGdV56e.js";const{t:B}=e.global,S=(e,a)=>({programId:e,gridId:a,gridTitle:B(`${e}.title`),setting:{isReadOnly:!0},columns:[x.hidden({name:"boardType"}),x.hidden({name:"idx"}),x.text({headerText:B(`${e}.subject`),name:"subject",width:"200",textAlign:"left",editable:!1}),x.text({headerText:B(`${e}.content`),name:"content",width:"400",textAlign:"left",editable:!1}),x.text({headerText:B(`${e}.dateRange`),name:"dateRange",width:"400",textAlign:"center",editable:!1}),x.text({headerText:B(`${e}.insertDate`),name:"insertDate",width:"100",textAlign:"center",editable:!1,visible:!1}),x.text({headerText:B(`${e}.insertUserNm`),name:"insertUserNm",width:"100",textAlign:"center",editable:!1}),x.button({headerText:B(`${e}.action`),name:"action",width:"100"})]});const $=a(Object.assign({menuId:"boardMgmt",programId:"BoardMgmt"},{__name:"BoardMgmt",setup(e,{expose:a}){a();const t=u(),r=f(),i=t.currentRoute.value.fullPath.split("/").pop(),d=`${i}Mgmt`,o=r?.type.programId,{t:n}=c(),l=m("emitter"),s=`mittMenuCheck_${d}`;l.on(s,async e=>{await k.isChangeRowData([{dataProvider:H.value}])&&l.emit(`mitt${e.target}MenuClickEvent`,e.data)});const R=i,x=p.cloneDeep(S(o,R)),B=v({isReady:!1,search:{},gridTitle:x.gridTitle,gridView:null,dataProvider:null,gridCellClickData:{},selectedRowInfo:{},isPopup:!1,boardColumnInfo:{}}),{isReady:$,search:_,gridTitle:M,gridView:U,dataProvider:H,gridCellClickData:N,selectedRowInfo:E,isPopup:G,boardColumnInfo:O}=g(B);h(async()=>{$.value=!1,await C({programId:o}),L(),await W(),$.value=!0}),w(()=>{l.off(s),p.clearAuth(o)}),I(async()=>{await C({programId:o})}),b(async()=>{p.clearAuth(o)});const q=async()=>{await y({menuId:"BoardStgMgmt",params:_.value}).then(async e=>{e.data.length>0&&e.data.forEach(e=>{Object.keys(e).forEach(a=>{if(["dateRange"].includes(a)){O.value=Object.assign(O.value,{[a]:e[a]});const t="Y"===e[a];U.value.setColumnProperty(a,"visible",t)}})})})},F=()=>{y({menuId:o,params:_.value}).then(e=>{k.setData({gridView:U.value,dataProvider:H.value,data:e.data})})},J=e=>{y({method:"post",menuId:o,data:e}).then(()=>{F()})},L=()=>{_.value={boardType:i,idName:""}},W=async()=>{},Y=(e={})=>(E.value=e,G.value=!0,{result:!1}),z={router:t,instance:r,boardType:i,menuId:d,programId:o,t:n,emitter:l,mittMenuCheck:s,gridId:R,gridConfig:x,data:B,isReady:$,search:_,gridTitle:M,gridView:U,dataProvider:H,gridCellClickData:N,selectedRowInfo:E,isPopup:G,boardColumnInfo:O,getColumnList:q,getDataHandler:F,saveDataHandler:J,resetHandler:L,init:W,searchHandler:async()=>{await k.isChangeRowData([{dataProvider:H.value}])&&F()},popupCallBack:(e,a)=>{"created"===e?k.addRow({dataProvider:H.value,row:a}):k.updateRow({gridView:U.value,dataProvider:H.value,dataRow:N.value.dataRow,updateRow:a})},gridInit:async(e,a)=>{U.value=e,H.value=a,await q(),F()},gridAddClick:Y,gridCellItemClicked:async(e,a,t)=>{const r=k.getJsonRow({dataProvider:H.value,dataRow:t.dataRow});N.value=t,Y(r)},gridSaveClick:async()=>{if(await k.checkValidation({gridView:U.value,dataProvider:H.value})){const e=await k.saveData({gridView:U.value,dataProvider:H.value});e.isConfirmed&&J(e.data)}},getCurrentInstance:f,inject:m,onActivated:I,onBeforeMount:h,onDeactivated:b,onUnmounted:w,reactive:v,toRefs:g,get useI18n(){return c},get useRouter(){return u},get utils(){return p},get apiCommon(){return y},get apiPageAuth(){return C},ElementText:P,get gridUtils(){return k},RealGrid:T,ContainerView:j,PopupContainer:V,SearchContainer:A,BoardPopup:D,get gridSetting(){return S}};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),[["render",function(e,a,u,c,m,g){return R(),t(s,null,[c.isReady?(R(),r(c.ContainerView,{key:0},{default:d(()=>[o(c.SearchContainer,{onSearch:c.searchHandler,onReset:c.resetHandler},{colgroup:d(()=>a[2]||(a[2]=[n("col",{style:{width:"100px"}},null,-1),n("col",{style:{width:"250px"}},null,-1),n("col",{width:"*"},null,-1)])),default:d(()=>[n("tbody",null,[n("tr",null,[n("th",null,l(c.t(`${c.programId}.search.idName.title`)),1),n("td",null,[o(c.ElementText,{modelValue:c.search.idName,"onUpdate:modelValue":a[0]||(a[0]=e=>c.search.idName=e),placeholder:c.t(`${c.programId}.search.idName.title.placeholder`)},null,8,["modelValue","placeholder"])]),a[3]||(a[3]=n("td",null,null,-1))])])]),_:1}),o(c.RealGrid,{gridTitle:c.gridTitle,gridConfig:c.gridConfig,gridAddClick:c.gridAddClick,onGridInit:c.gridInit,onGridCellItemClicked:c.gridCellItemClicked,onGridSaveClick:c.gridSaveClick},null,8,["gridTitle","gridConfig"])]),_:1})):i("",!0),c.isPopup?(R(),r(c.PopupContainer,{key:1,modelValue:c.isPopup,"onUpdate:modelValue":a[1]||(a[1]=e=>c.isPopup=e),title:"게시글 등록"},{default:d(e=>[o(c.BoardPopup,{slotProps:e,boardType:c.boardType,boardColumnInfo:c.boardColumnInfo,selectedRowInfo:c.selectedRowInfo,onCallBackHandler:c.popupCallBack},null,8,["slotProps","boardType","boardColumnInfo","selectedRowInfo"])]),_:1},8,["modelValue"])):i("",!0)],64)}],["__file","/Users/kokimin/WorkSpace/vue_design_system/src/views/BoardMgmt/BoardMgmt.vue"]]);export{$ as default};
